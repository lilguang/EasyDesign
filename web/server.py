import osimport sysfrom pathlib import Pathroot_dir = Path(__file__).resolve().parent.parentwork_space = str(root_dir) + os.sepsys.path.append(work_space)import uvicorn as uvicornfrom fastapi import FastAPI, HTTPException, Formfrom web.options.options import SERVER_PORTfrom web.model.model import Adaptorfrom web.service.service import runAdaptCmd, convert_and_uploadapp = FastAPI()# Health probe@app.get('/')def index():    return {'message': 'Welcome to EasyDesign service!'}# Submit sgRNA design work@app.post('/postadapt')async def postAdapt(adaptor: Adaptor):    ret = runAdaptCmd(adaptor)    if ret == 0:        return {'message': 'paras : ' + str(adaptor) + " starts to run"}    else:        raise HTTPException(status_code=501, detail='paras : ' + str(adaptor) + " exit with " + str(ret))# Upload result to remote@app.post('/upload_result')def uploadResult(uploadResultAddr: str = Form(), jobId: str = Form()):    convert_and_upload(uploadResultAddr, jobId)    return {'message': 'jodID : ' + str(jobId) + " done"}if __name__ == '__main__':    uvicorn.run(app, host="0.0.0.0", port=SERVER_PORT, workers=min(os.cpu_count() - 4, 1), reload=False)